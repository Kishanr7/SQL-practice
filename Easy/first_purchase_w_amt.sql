CREATE TABLE purchases ( purchase_id INT, customer_id INT, purchase_date DATE, amount INT ); INSERT INTO purchases VALUES (1, 101, '2026-01-01', 500), (2, 101, '2026-01-10', 300), (3, 102, '2026-01-05', 200), (4, 102, '2026-01-20', 400), (5, 103, '2026-01-07', 150); WITH cte_1 AS ( SELECT customer_id, purchase_date, amount, RANK() OVER(PARTITION BY customer_id ORDER BY purchase_date) as rnk FROM purchases ) SELECT customer_id, purchase_date as first_purchase_date, amount FROM cte_1 WHERE rnk = 1